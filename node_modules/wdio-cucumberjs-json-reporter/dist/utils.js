import stripAnsi from 'strip-ansi';
import { dialects } from '@cucumber/gherkin';
import { FAILED } from './constants.js';
export function getStepKeywords(language) {
    const dialect = dialects[language];
    return []
        .concat(dialect.given, dialect.when, dialect.then, dialect.and)
        .map((keyword) => keyword.replace(/\s*$/, ''));
}
export function getFailedMessage(testObject) {
    if (testObject.state === FAILED) {
        return {
            error_message: stripAnsi(testObject.error.stack),
        };
    }
    return {};
}
export function containsSteps(steps, language) {
    const stepKeywords = getStepKeywords(language);
    return steps.some((step) => stepKeywords.includes(step.keyword));
}
export function keywordStartsWith(title, language) {
    const stepKeywords = [].concat(getStepKeywords(language), ['After', 'Before']);
    const escapedStepKeywords = stepKeywords.map((keyword) => keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'));
    const regex = new RegExp(`^(${escapedStepKeywords.join('|')})\\s`);
    return (regex.exec(title) || []).pop();
}
//# sourceMappingURL=utils.js.map